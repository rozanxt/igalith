% Parametrization of a single quadrilateralized spherical cube patch
function nrb = nrb_quad_sphere
    pts = zeros(4, 5, 5);
    pts(:, 1, 1) = [-0.577350269189626; -0.577350269189626;  0.577350269189626;  1.000000000000000];
    pts(:, 2, 1) = [-0.278838767912603; -0.632392158505876;  0.632392158505876;  0.891211203608397];
    pts(:, 3, 1) = [ 0.000000000000000; -0.647791890991355;  0.647791890991355;  0.859116756396542];
    pts(:, 4, 1) = [ 0.278838767912603; -0.632392158505876;  0.632392158505876;  0.891211203608397];
    pts(:, 5, 1) = [ 0.577350269189626; -0.577350269189626;  0.577350269189626;  1.000000000000000];
    pts(:, 1, 2) = [-0.632392158505876; -0.278838767912603;  0.632392158505876;  0.891211203608397];
    pts(:, 2, 2) = [-0.315090742770461; -0.315090742770461;  0.762259526419164;  0.762259526419164];
    pts(:, 3, 2) = [ 0.000000000000000; -0.328648516366383;  0.804938188574224;  0.718665173540050];
    pts(:, 4, 2) = [ 0.315090742770461; -0.315090742770461;  0.762259526419164;  0.762259526419164];
    pts(:, 5, 2) = [ 0.632392158505876; -0.278838767912603;  0.632392158505876;  0.891211203608397];
    pts(:, 1, 3) = [-0.647791890991355;  0.000000000000000;  0.647791890991355;  0.859116756396542];
    pts(:, 2, 3) = [-0.328648516366383;  0.000000000000000;  0.804938188574224;  0.718665173540050];
    pts(:, 3, 3) = [ 0.000000000000000;  0.000000000000000;  0.859116756396542;  0.671272431591931];
    pts(:, 4, 3) = [ 0.328648516366383;  0.000000000000000;  0.804938188574224;  0.718665173540050];
    pts(:, 5, 3) = [ 0.647791890991355;  0.000000000000000;  0.647791890991355;  0.859116756396542];
    pts(:, 1, 4) = [-0.632392158505876;  0.278838767912603;  0.632392158505876;  0.891211203608397];
    pts(:, 2, 4) = [-0.315090742770461;  0.315090742770461;  0.762259526419164;  0.762259526419164];
    pts(:, 3, 4) = [ 0.000000000000000;  0.328648516366383;  0.804938188574224;  0.718665173540050];
    pts(:, 4, 4) = [ 0.315090742770461;  0.315090742770461;  0.762259526419164;  0.762259526419164];
    pts(:, 5, 4) = [ 0.632392158505876;  0.278838767912603;  0.632392158505876;  0.891211203608397];
    pts(:, 1, 5) = [-0.577350269189626;  0.577350269189626;  0.577350269189626;  1.000000000000000];
    pts(:, 2, 5) = [-0.278838767912603;  0.632392158505876;  0.632392158505876;  0.891211203608397];
    pts(:, 3, 5) = [ 0.000000000000000;  0.647791890991355;  0.647791890991355;  0.859116756396542];
    pts(:, 4, 5) = [ 0.278838767912603;  0.632392158505876;  0.632392158505876;  0.891211203608397];
    pts(:, 5, 5) = [ 0.577350269189626;  0.577350269189626;  0.577350269189626;  1.000000000000000];
    knt = {[0, 0, 0, 0, 0, 1, 1, 1, 1, 1], [0, 0, 0, 0, 0, 1, 1, 1, 1, 1]};
    nrb = nrbmak(pts, knt);
end
